<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>JLPT N5 Flashcards — Carousel</title>

<!-- Minimal Bootstrap for utilities (optional) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  :root{
    --accent: #b99bff;       
    --accent-dark: #9a7bff;
    --card-bg: #fff8dc;
    --muted: #666;
  }

  body{
    margin:0;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    color:#222;
    background: linear-gradient(180deg,#fbfdff 0%, #f3f6fb 100%);
    min-height:100vh;
    display:flex;
    flex-direction:column;
  }

  .site-nav{
    background: rgba(185,155,255,0.10);
    border-bottom:1px solid rgba(0,0,0,0.04);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    padding: 10px 14px;
    display:flex;
    align-items:center;
    gap:12px;
    z-index: 60;
  }

  .site-nav .brand{
    color: var(--accent-dark);
    font-weight:700;
    font-size:1.1rem;
    text-decoration:none;
  }

  .site-nav .nav-link{
    color:#333;
    font-weight:600;
  }

  .site-nav .btn-primary{
    background: var(--accent);
    border-color: var(--accent-dark);
    color: #fff;
    padding: 8px 12px;
    border-radius: 8px;
    font-weight:700;
    transition: background .18s ease, color .18s ease, box-shadow .18s ease, border-color .18s ease;
  }

  .site-nav .btn-primary:hover,
  .site-nav .btn-primary:focus{
    background: transparent !important;
    color: var(--accent-dark) !important;
    border-color: var(--accent-dark) !important;
    box-shadow: none !important;
  }

  .site-nav .btn-outline-info{
    color: var(--accent-dark);
    border-color: rgba(154,123,255,0.28);
    background: transparent;
    padding: 8px 12px;
    border-radius: 8px;
    font-weight:700;
    transition: background .18s ease, color .18s ease, border-color .18s ease, box-shadow .18s ease;
  }

  .site-nav .btn-outline-info:hover,
  .site-nav .btn-outline-info:focus{
    background: var(--accent);
    color: #fff;
    border-color: var(--accent-dark);
    box-shadow: 0 8px 20px rgba(154,123,255,0.12);
  }

  .carousel-band{
    width:100%;
    padding:48px 12px 20px 12px;
    box-sizing:border-box;
    display:flex;
    justify-content:center;
    align-items:center;
  }

  .carousel-viewport{
    width: 100%;
    max-width: 1100px;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:16px;
    position:relative;
    perspective:1200px;
    -webkit-perspective:1200px;
  }

  .flashcard{
    width: min(720px, 88vw);
    height: min(340px, 46vh);
    background: var(--card-bg);
    border-radius:14px;
    box-shadow: 0 18px 40px rgba(60,40,120,0.08);
    border:1px solid rgba(0,0,0,0.06);
    overflow:hidden;
    position:relative;
    transform-style: preserve-3d;
    -webkit-transform-style: preserve-3d;
    transition: none;
    cursor: pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    will-change: transform;
  }

  .face{
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    padding:28px;
    box-sizing:border-box;
    text-align:center;
    backface-visibility:hidden;
    -webkit-backface-visibility:hidden;
    transform-style:preserve-3d;
    -webkit-transform-style:preserve-3d;
    transition: transform 0.6s cubic-bezier(.2,.9,.3,1), opacity .22s ease;
    -webkit-transition: -webkit-transform 0.6s cubic-bezier(.2,.9,.3,1), opacity .22s ease;
    will-change: transform, opacity;
  }

  .face.front{ transform: rotateY(0deg); opacity:1; }
  .face.back { transform: rotateY(180deg); opacity:0; }

  .flashcard.flipped .front{
    transform: rotateY(-180deg);
    -webkit-transform: rotateY(-180deg);
    opacity:0;
  }
  .flashcard.flipped .back{
    transform: rotateY(0deg);
    -webkit-transform: rotateY(0deg);
    opacity:1;
  }

  .word{
    font-size: clamp(28px, 4.2vw, 44px);
    font-weight:800;
    color:#111;
    margin-bottom:12px;
    line-height:1;
  }
  .sentence, .meaning{
    font-size: clamp(14px, 1.6vw, 20px);
    color:#222;
    max-width:86%;
    line-height:1.5;
    white-space:pre-wrap;
  }

  .status-pill{
    position:absolute;
    left:14px;
    top:14px;
    padding:6px 10px;
    border-radius:999px;
    font-weight:700;
    font-size:13px;
    color:#fff;
    display:inline-flex;
    align-items:center;
    gap:8px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
  }
  .status-known { background: #7fd39a; }
  .status-unknown { background: #ee4b2b; }
  .status-none { background: rgba(0,0,0,0.06); color:#222; }

  .control{
    background:#fff;
    border-radius:10px;
    width:56px;
    height:56px;
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow: 0 8px 18px rgba(40,30,60,0.06);
    border:1px solid rgba(0,0,0,0.04);
    cursor:pointer;
    transition: transform .12s ease, background .12s ease, box-shadow .12s ease;
    user-select:none;
  }
  .control:hover{
    transform: translateY(-3px);
    background: rgba(0,0,0,0.02);
    box-shadow: 0 12px 22px rgba(40,30,60,0.08);
  }

  .controls-left, .controls-right{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    z-index:5;
  }
  .controls-left { left: -74px; }
  .controls-right { right: -74px; }

  @media (max-width:900px){
    .controls-left { left: 8px; }
    .controls-right { right: 8px; }
    .flashcard { width: min(88vw, 680px); height: clamp(220px, 46vh, 380px); }
    .word { font-size: clamp(20px, 7.6vw, 38px); }
    .btn { padding:12px 14px; }
    .meta { font-size:14px; padding:10px 14px; }
    .card-toolbar { gap:8px; }
    .status-pill { font-size:12px; padding:6px 8px; left:10px; top:10px; }
  }
  
  @media (max-width:420px){
  /* Hide sign in/up buttons */
  .site-nav .btn-outline-info,
  .site-nav .btn-primary {
    display: none;
  }

  /* Hide all other toolbar buttons except I Know / I Don't Know */
  #prevBtn, #flipBtn, #nextBtn, #unknownOnlyBtn, #resetBtn {
    display: none;
  }

  /* Keep I Know / I Don't Know side by side */
  .card-toolbar { 
    width:100%; 
    display:flex; 
    flex-direction: row; 
    gap: 30px; 
    justify-content:center;
  }

  /* Hide footer */
  footer.site-footer {
    display: none;
  }
}



  .toolbar-band{
    width:100%;
    display:flex;
    justify-content:center;
    margin-top:8px;
    padding:18px 12px 40px 12px;
    box-sizing:border-box;
  }
  .toolbar-inner{
    width:100%;
    max-width:820px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:12px;
  }
  .card-toolbar{
    display:flex;
    gap:10px;
    align-items:center;
    justify-content:center;
    flex-wrap:wrap;
  }

  .btn{
    border-radius:10px;
    padding:10px 16px;
    font-weight:700;
    transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
  }

  .btn-primary { background:var(--accent); border-color:var(--accent-dark); color:#fff; }
  .btn-ghost { background:transparent; border: 1px solid rgba(0,0,0,0.08); color:#222; }

  #knowBtn:hover, #knowBtn:focus{
    background:#7fd39a !important;
    border-color:#6fc386 !important;
    color:#0b2b12 !important;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(127,211,154,0.18);
  }

  #dontKnowBtn:hover, #dontKnowBtn:focus{
    background:#ee4b2b !important;
    border-color:#d4401f !important;
    color:#fff !important;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(238,75,43,0.18);
  }

  .btn-ghost:hover, .btn-ghost:focus, .control:hover, .btn-ghost:active{
    background: rgba(0,0,0,0.03);
    transform: translateY(-2px);
    box-shadow: 0 10px 18px rgba(20,20,40,0.04);
  }

  .meta-bar{
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:center;
    margin-bottom:0;
  }
  .meta{
    background:#ffffff;
    padding:8px 12px;
    border-radius:8px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
    font-weight:700;
  }

  footer.site-footer{
    margin-top:auto;
    padding:18px;
    text-align:center;
    font-size:14px;
    color:var(--muted);
    border-top:1px solid rgba(0,0,0,0.03);
    background:transparent;
  }

  .muted { color:var(--muted); font-weight:500; }

  .control, .btn, .flashcard{
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }
</style>

</head>
<body>

<!-- NAVBAR -->
<header class="site-nav py-2">
  <div class="container d-flex align-items-center justify-content-between">
    <a class="brand" href="/">Anki Go</a>
    <nav>
      <a class="nav-link d-inline-block me-3" href="/">Home</a>
      <a class="nav-link d-inline-block me-3" href="/deck/create_deck_general_knowledge/">Create a Deck</a>
      <a class="nav-link d-inline-block me-3" href="/anki-decks/shared/">My Decks</a>
      <a class="btn btn-outline-info btn-sm" href="/accounts/login/">Log in</a>
      <a class="btn btn-primary btn-sm ms-2" href="/users/accounts/signup/">Sign up</a>
    </nav>
  </div>
</header>

<!-- CAROUSEL BAND (100% width) -->
<section class="carousel-band">
  <div class="carousel-viewport" role="region" aria-label="Flashcard carousel">
    <div class="controls-left">
      <div id="prevControl" class="control" title="Previous (←)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M15 18L9 12L15 6" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
    </div>

    <!-- Flashcard canvas styled div -->
    <div id="card" class="flashcard" tabindex="0" aria-label="Flashcard — click to flip">
      <div id="statusPill" class="status-pill status-none">New</div>

      <div class="face front" id="faceFront">
        <div class="word" id="wordText">学生</div>
        <div class="sentence muted" id="sentenceText">私は学生です。</div>
      </div>

      <div class="face back" id="faceBack" aria-hidden="true">
        <div class="word" style="font-weight:700; font-size:20px;">Meaning</div>
        <div class="meaning" id="meaningText">がくせい\nStudent\nI am a student.</div>
      </div>
    </div>

    <div class="controls-right">
      <div id="nextControl" class="control" title="Next (→)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M9 6L15 12L9 18" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
    </div>
  </div>
</section>

<!-- TOOLBAR (moved below the carousel so it no longer overlaps the card) -->
<div class="toolbar-band">
  <div class="toolbar-inner">
    <div class="meta-bar">
      <div class="meta" id="counter">Card 1 / 100</div>
      <div class="meta" id="knownMeta">Known: 0</div>
      <div class="meta" id="unknownMeta">Unknown: 0</div>
    </div>

    <div class="card-toolbar">
      <button id="prevBtn" class="btn btn-ghost">Previous</button>
      <button id="flipBtn" class="btn btn-ghost">Flip</button>
      <button id="nextBtn" class="btn btn-ghost">Next</button>

      <button id="knowBtn" class="btn btn-primary">I Know</button>
      <button id="dontKnowBtn" class="btn btn-primary">I Don't Know</button>

      <button id="unknownOnlyBtn" class="btn btn-ghost">Show Unknown Only</button>
      <button id="resetBtn" class="btn btn-ghost">Reset</button>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer class="site-footer">
  <div class="container">
    <div>Anki Go — JLPT N5 practice</div>
    <div class="muted">Progress is saved locally in your browser. &middot; Designed to be dropped into any page as a centered component.</div>
  </div>
</footer>

<script>
/* ---------- Data (same as original) ---------- */
const vocab = [
  { word: "学生", sentence: "私は学生です。", meaning: "がくせい\nStudent\nI am a student." },
  { word: "先生", sentence: "先生は教室にいます。", meaning: "せんせい\nTeacher\nThe teacher is in the classroom." },
  { word: "学校", sentence: "学校へ行きます。", meaning: "がっこう\nSchool\nI go to school." },
  { word: "本", sentence: "本を読みます。", meaning: "ほん\nBook\nI read a book." },
  { word: "車", sentence: "車があります。", meaning: "くるま\nCar\nThere is a car." },
  { word: "猫", sentence: "猫が好きです。", meaning: "ねこ\nCat\nI like cats." },
  { word: "犬", sentence: "犬はかわいいです。", meaning: "いぬ\nDog\nDogs are cute." },
  { word: "水", sentence: "水を飲みます。", meaning: "みず\nWater\nI drink water." },
  { word: "食べる", sentence: "りんごを食べます。", meaning: "たべる\nTo eat\nI eat an apple." },
  { word: "飲む", sentence: "お茶を飲みます。", meaning: "のむ\nTo drink\nI drink tea." },
  { word: "行く", sentence: "学校に行きます。", meaning: "いく\nTo go\nI go to school." },
  { word: "来る", sentence: "友達が来ます。", meaning: "くる\nTo come\nA friend comes." },
  { word: "見る", sentence: "テレビを見ます。", meaning: "みる\nTo see, watch\nI watch TV." },
  { word: "話す", sentence: "日本語を話します。", meaning: "はなす\nTo speak\nI speak Japanese." },
  { word: "買う", sentence: "本を買います。", meaning: "かう\nTo buy\nI buy a book." },
  { word: "飲み物", sentence: "飲み物をください。", meaning: "のみもの\nDrink (noun)\nPlease give me a drink." },
  { word: "昼ご飯", sentence: "昼ご飯を食べます。", meaning: "ひるごはん\nLunch\nI eat lunch." },
  { word: "朝", sentence: "朝は早いです。", meaning: "あさ\nMorning\nMorning is early." },
  { word: "晩ご飯", sentence: "晩ご飯を作ります。", meaning: "ばんごはん\nDinner\nI make dinner." },
  { word: "今", sentence: "今は忙しいです。", meaning: "いま\nNow\nI am busy now." },
  { word: "時間", sentence: "時間があります。", meaning: "じかん\nTime\nI have time." },
  { word: "友達", sentence: "友達と遊びます。", meaning: "ともだち\nFriend\nI play with friends." },
  { word: "家", sentence: "家に帰ります。", meaning: "いえ\nHouse, home\nI return home." },
  { word: "父", sentence: "父は仕事に行きます。", meaning: "ちち\nFather\nMy father goes to work." },
  { word: "母", sentence: "母は料理が上手です。", meaning: "はは\nMother\nMy mother is good at cooking." },
  { word: "兄", sentence: "兄は大学生です。", meaning: "あに\nOlder brother\nMy older brother is a university student." },
  { word: "弟", sentence: "弟は小学生です。", meaning: "おとうと\nYounger brother\nMy younger brother is an elementary student." },
  { word: "姉", sentence: "姉は会社員です。", meaning: "あね\nOlder sister\nMy older sister is an office worker." },
  { word: "妹", sentence: "妹は中学生です。", meaning: "いもうと\nYounger sister\nMy younger sister is a middle school student." },
  { word: "天気", sentence: "今日の天気はいいです。", meaning: "てんき\nWeather\nToday's weather is good." },
  { word: "雨", sentence: "雨が降っています。", meaning: "あめ\nRain\nIt is raining." },
  { word: "暑い", sentence: "今日は暑いです。", meaning: "あつい\nHot\nIt is hot today." },
  { word: "寒い", sentence: "冬は寒いです。", meaning: "さむい\nCold\nWinter is cold." },
  { word: "高い", sentence: "この店は高いです。", meaning: "たかい\nExpensive, tall\nThis shop is expensive." },
  { word: "安い", sentence: "リンゴは安いです。", meaning: "やすい\nCheap\nApples are cheap." },
  { word: "大きい", sentence: "あの家は大きいです。", meaning: "おおきい\nBig\nThat house is big." },
  { word: "小さい", sentence: "この犬は小さいです。", meaning: "ちいさい\nSmall\nThis dog is small." },
  { word: "新しい", sentence: "新しい車を買いました。", meaning: "あたらしい\nNew\nI bought a new car." },
  { word: "古い", sentence: "古い本を読みます。", meaning: "ふるい\nOld\nI read an old book." },
  { word: "好き", sentence: "音楽が好きです。", meaning: "すき\nLike\nI like music." },
  { word: "嫌い", sentence: "納豆が嫌いです。", meaning: "きらい\nDislike\nI dislike natto." },
  { word: "上手", sentence: "彼は日本語が上手です。", meaning: "じょうず\nSkilled\nHe is good at Japanese." },
  { word: "下手", sentence: "私は歌が下手です。", meaning: "へた\nUnskilled\nI am bad at singing." },
  { word: "早い", sentence: "朝は早く起きます。", meaning: "はやい\nEarly, fast\nI get up early in the morning." },
  { word: "遅い", sentence: "電車が遅いです。", meaning: "おそい\nLate, slow\nThe train is late." },
  { word: "美味しい", sentence: "この料理は美味しいです。", meaning: "おいしい\nDelicious\nThis food is delicious." },
  { word: "飲みます", sentence: "水を飲みます。", meaning: "のみます\nTo drink\nI drink water." },
  { word: "行きます", sentence: "学校に行きます。", meaning: "いきます\nTo go\nI go to school." },
  { word: "来ます", sentence: "友達が来ます。", meaning: "きます\nTo come\nA friend comes." },
  { word: "見ます", sentence: "映画を見ます。", meaning: "みます\nTo see, watch\nI watch a movie." },
  { word: "話します", sentence: "日本語を話します。", meaning: "はなします\nTo speak\nI speak Japanese." },
  { word: "書きます", sentence: "手紙を書きます。", meaning: "かきます\nTo write\nI write a letter." },
  { word: "読みます", sentence: "本を読みます。", meaning: "よみます\nTo read\nI read a book." },
  { word: "買います", sentence: "パンを買います。", meaning: "かいます\nTo buy\nI buy bread." },
  { word: "します", sentence: "勉強をします。", meaning: "します\nTo do\nI study." },
  { word: "食べます", sentence: "ご飯を食べます。", meaning: "たべます\nTo eat\nI eat rice." },
  { word: "休みます", sentence: "学校を休みます。", meaning: "やすみます\nTo rest, take a day off\nI take a day off school." },
  { word: "話", sentence: "いい話ですね。", meaning: "はなし\nTalk, story\nThat's a good story." },
  { word: "店", sentence: "新しい店があります。", meaning: "みせ\nShop, store\nThere is a new store." },
  { word: "駅", sentence: "駅に着きました。", meaning: "えき\nStation\nI arrived at the station." },
  { word: "空", sentence: "空が青いです。", meaning: "そら\nSky\nThe sky is blue." },
  { word: "道", sentence: "道を教えてください。", meaning: "みち\nRoad, way\nPlease tell me the way." },
  { word: "昼", sentence: "昼ご飯を食べます。", meaning: "ひる\nNoon, lunch\nI eat lunch." },
  { word: "夜", sentence: "夜は寒いです。", meaning: "よる\nNight\nIt is cold at night." },
  { word: "外", sentence: "外で遊びます。", meaning: "そと\nOutside\nI play outside." },
  { word: "中", sentence: "部屋の中にいます。", meaning: "なか\nInside\nI am inside the room." },
  { word: "上", sentence: "机の上に本があります。", meaning: "うえ\nAbove, on\nThere is a book on the desk." },
  { word: "下", sentence: "椅子の下に猫がいます。", meaning: "した\nBelow, under\nThere is a cat under the chair." },
  { word: "右", sentence: "右に曲がってください。", meaning: "みぎ\nRight\nPlease turn right." },
  { word: "左", sentence: "左に行きます。", meaning: "ひだり\nLeft\nI go left." },
  { word: "新幹線", sentence: "新幹線に乗ります。", meaning: "しんかんせん\nBullet train\nI ride the bullet train." },
  { word: "電話", sentence: "電話をかけます。", meaning: "でんわ\nTelephone\nI make a phone call." },
  { word: "本屋", sentence: "本屋で本を買います。", meaning: "ほんや\nBookstore\nI buy books at the bookstore." },
  { word: "病院", sentence: "病院に行きます。", meaning: "びょういん\nHospital\nI go to the hospital." },
  { word: "銀行", sentence: "銀行でお金をおろします。", meaning: "ぎんこう\nBank\nI withdraw money at the bank." },
  { word: "郵便局", sentence: "郵便局で手紙を出します。", meaning: "ゆうびんきょく\nPost office\nI send a letter at the post office." },
  { word: "空港", sentence: "空港へ行きます。", meaning: "くうこう\nAirport\nI go to the airport." },
  { word: "時計", sentence: "時計を見ます。", meaning: "とけい\nClock, watch\nI look at the clock." },
  { word: "花", sentence: "花がきれいです。", meaning: "はな\nFlower\nThe flower is beautiful." },
  { word: "山", sentence: "山に登ります。", meaning: "やま\nMountain\nI climb a mountain." },
  { word: "川", sentence: "川で泳ぎます。", meaning: "かわ\nRiver\nI swim in the river." },
  { word: "海", sentence: "海に行きます。", meaning: "うみ\nSea, ocean\nI go to the sea." },
  { word: "魚", sentence: "魚を食べます。", meaning: "さかな\nFish\nI eat fish." },
  { word: "鳥", sentence: "鳥が飛んでいます。", meaning: "とり\nBird\nThe bird is flying." },
  { word: "店員", sentence: "店員に聞きます。", meaning: "てんいん\nShop clerk\nI ask the clerk." },
  { word: "旅行", sentence: "旅行に行きます。", meaning: "りょこう\nTravel\nI go on a trip." },
  { word: "勉強", sentence: "日本語を勉強します。", meaning: "べんきょう\nStudy\nI study Japanese." },
  { word: "仕事", sentence: "仕事に行きます。", meaning: "しごと\nWork, job\nI go to work." },
  { word: "遊ぶ", sentence: "公園で遊びます。", meaning: "あそぶ\nTo play\nI play at the park." },
  { word: "寝る", sentence: "早く寝ます。", meaning: "ねる\nTo sleep\nI go to bed early." },
  { word: "起きる", sentence: "朝6時に起きます。", meaning: "おきる\nTo wake up\nI wake up at 6 a.m." }
];

/* ---------- State & UI bindings (unchanged except toolbar reposition) ---------- */
const card = document.getElementById('card');
const wordText = document.getElementById('wordText');
const sentenceText = document.getElementById('sentenceText');
const meaningText = document.getElementById('meaningText');
const faceBack = document.getElementById('faceBack');
const faceFront = document.getElementById('faceFront');
const statusPill = document.getElementById('statusPill');

const counter = document.getElementById('counter');
const knownMeta = document.getElementById('knownMeta');
const unknownMeta = document.getElementById('unknownMeta');

const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const flipBtn = document.getElementById('flipBtn');
const knowBtn = document.getElementById('knowBtn');
const dontKnowBtn = document.getElementById('dontKnowBtn');
const resetBtn = document.getElementById('resetBtn');
const unknownOnlyBtn = document.getElementById('unknownOnlyBtn');
const prevControl = document.getElementById('prevControl');
const nextControl = document.getElementById('nextControl');

let currentIndex = 0;
let showingFront = true;
let showingUnknownOnly = false;
let unknownIndexes = [];

/* Load status from localStorage if available */
let cardStatus = JSON.parse(localStorage.getItem('cardStatus') || 'null');
if (!Array.isArray(cardStatus) || cardStatus.length !== vocab.length) {
  cardStatus = new Array(vocab.length).fill(null);
}

/* helpers */
function saveStatus(){ localStorage.setItem('cardStatus', JSON.stringify(cardStatus)); }
function updateCounters(){
  const knownCount = cardStatus.filter(s => s==='known').length;
  const unknownCount = cardStatus.filter(s => s==='unknown').length;
  knownMeta.textContent = `Known: ${knownCount}`;
  unknownMeta.textContent = `Unknown: ${unknownCount}`;
  counter.textContent = showingUnknownOnly ? `Unknown ${unknownIndexes.indexOf(currentIndex)+1} / ${unknownIndexes.length}` : `Card ${currentIndex+1} / ${vocab.length}`;
}
function updateUnknownIndexes(){
  unknownIndexes = [];
  cardStatus.forEach((s,i)=> { if (s==='unknown') unknownIndexes.push(i); });
}

/* render */
function renderCard(){
  const entry = vocab[currentIndex];
  wordText.textContent = entry.word;
  sentenceText.textContent = entry.sentence;
  meaningText.textContent = entry.meaning;
  // status pill
  if (cardStatus[currentIndex]==='known'){
    statusPill.className = 'status-pill status-known';
    statusPill.textContent = 'Known';
  } else if (cardStatus[currentIndex]==='unknown'){
    statusPill.className = 'status-pill status-unknown';
    statusPill.textContent = 'Unknown';
  } else {
    statusPill.className = 'status-pill status-none';
    statusPill.textContent = 'New';
  }
  // ensure front/back ARIA
  faceBack.setAttribute('aria-hidden', showingFront ? 'true' : 'false');
  faceFront.setAttribute('aria-hidden', showingFront ? 'false' : 'true');

  updateCounters();
}

/* navigation */
function showNext(){
  if (showingUnknownOnly){
    if (!unknownIndexes.length) return;
    let pos = unknownIndexes.indexOf(currentIndex);
    pos = (pos + 1) % unknownIndexes.length;
    currentIndex = unknownIndexes[pos];
  } else {
    currentIndex = (currentIndex + 1) % vocab.length;
  }
  showingFront = true;
  card.classList.remove('flipped');
  renderCard();
}
function showPrev(){
  if (showingUnknownOnly){
    if (!unknownIndexes.length) return;
    let pos = unknownIndexes.indexOf(currentIndex);
    pos = (pos - 1 + unknownIndexes.length) % unknownIndexes.length;
    currentIndex = unknownIndexes[pos];
  } else {
    currentIndex = (currentIndex - 1 + vocab.length) % vocab.length;
  }
  showingFront = true;
  card.classList.remove('flipped');
  renderCard();
}
function flip(){
  showingFront = !showingFront;
  if (showingFront) card.classList.remove('flipped'); else card.classList.add('flipped');
  renderCard();
}

/* marking */
function markKnown(){
  cardStatus[currentIndex] = 'known';
  saveStatus();
  updateUnknownIndexes();
  updateCounters();
  renderCard();
}
function markUnknown(){
  cardStatus[currentIndex] = 'unknown';
  saveStatus();
  updateUnknownIndexes();
  updateCounters();
  renderCard();
}

/* unknown only toggle */
function toggleUnknownOnly(){
  if (showingUnknownOnly){
    showingUnknownOnly = false;
    unknownOnlyBtn.textContent = "Show Unknown Only";
    currentIndex = 0;
  } else {
    updateUnknownIndexes();
    if (unknownIndexes.length===0){ alert('No unknown cards to review!'); return; }
    showingUnknownOnly = true;
    currentIndex = unknownIndexes[0];
    unknownOnlyBtn.textContent = "Show All Cards";
  }
  showingFront = true;
  card.classList.remove('flipped');
  renderCard();
}

function resetAll(){
  if (!confirm('Reset all progress?')) return;
  cardStatus = new Array(vocab.length).fill(null);
  saveStatus();
  updateUnknownIndexes();
  currentIndex = 0;
  showingFront = true;
  card.classList.remove('flipped');
  renderCard();
}

/* Event listeners */
card.addEventListener('click', (e)=> { flip(); });
flipBtn.addEventListener('click', flip);
nextBtn.addEventListener('click', showNext);
prevBtn.addEventListener('click', showPrev);
nextControl.addEventListener('click', showNext);
prevControl.addEventListener('click', showPrev);
knowBtn.addEventListener('click', markKnown);
dontKnowBtn.addEventListener('click', markUnknown);
unknownOnlyBtn.addEventListener('click', toggleUnknownOnly);
resetBtn.addEventListener('click', resetAll);

/* keyboard support */
document.addEventListener('keydown', (e)=>{
  if (e.key === 'ArrowRight') showNext();
  if (e.key === 'ArrowLeft') showPrev();
  if (e.key === ' ' || e.key === 'Spacebar') { e.preventDefault(); flip(); }
});

/* init */
updateUnknownIndexes();
updateCounters();
renderCard();

</script>

<!-- Optional bootstrap JS bundle for dropdowns if you need it elsewhere -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>


